---
layout: post
title: "백준 1557 - 제곱 ㄴㄴ"
tags: ["백준", "1557"]
comments: true
---

https://www.acmicpc.net/problem/1557

# 문제

![Problem](/images/boj1557/prob.png)

# 풀이

$k = 10^9$이므로 1부터 하나하나 제곱 ㄴㄴ 수인지 확인할 수 없다.

어떤 수가 제곱 ㄴㄴ 수인지 판별하는 것은 소인수분해를 하는 것과 같으므로 $O(\sqrt{n})$이다. 차라리 에라토스테네스의 체처럼 제곱 ㄴㄴ 수가 아닌 것을 걸러내며 푸는 것이 나아보였다.

소수 $p$에 대해 $p^2$의 배수는 제곱 ㄴㄴ 수가 아니고, 어떤 수 $x$보다 작은 수 중 $p^2$의 배수의 개수는 $\left\lfloor x / p^2 \right\rfloor$로 구할 수 있다.

소수를 미리 구해놓은 다음 포함-배제 원리를 써서 $x$보다 작은 제곱 ㄴㄴ 수의 개수를 구하는 함수 $f(x)$를 만들면 $f(x)=k-1 \ \land \ f(x-1)=k-2$인 $x$를 이진탐색 하듯 찾을 수 있을 것이라 생각했다.

$1,000,000,000$ 번째 제곱 ㄴㄴ 수가 얼마나 큰 수일지 궁금해서 일단 만들어서 구해보니 $1,644,934,081$가 나왔다. 소수를 $\left\lceil \sqrt{1,644,934,081} \right\rceil = 40558$까지 구하도록 고쳤다.

꽤 빨리 나오길래 제출해봤는데 시간 초과가 아니라 <span style="color: red;">틀렸습니다</span>가 나왔다.

$40559$로 바꾸고 $f(x)$의 탐색 범위를 완화하니까 정답처리 되었다.
